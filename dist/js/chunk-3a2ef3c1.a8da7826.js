(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a2ef3c1"],{"1a6f":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"columns"},[s("div",{staticClass:"column is-three-quarters"},[s("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[s("div",{staticClass:"has-text-centered",attrs:{slot:"header"},slot:"header"},[s("p",{staticClass:"is-size-5 has-text-weight-bold"},[t._v(t._s(t.topic.title))]),s("div",{staticClass:"has-text-grey is-size-7 mt-3"},[s("span",[t._v(t._s(t.dayjs(t.topic.createTime).format("YYYY/MM/DD HH:mm:ss")))]),s("el-divider",{attrs:{direction:"vertical"}}),s("span",[t._v("å‘å¸ƒè€…ï¼š"+t._s(t.topicUser.alias))]),s("el-divider",{attrs:{direction:"vertical"}}),s("span",[t._v("æŸ¥çœ‹ï¼š"+t._s(t.topic.view))])],1)]),s("div",{attrs:{id:"preview"}}),s("nav",{staticClass:"level has-text-grey is-size-7 mt-6"},[s("div",{staticClass:"level-left"},[s("p",{staticClass:"level-item"},[s("b-taglist",t._l(t.tags,(function(e,n){return s("router-link",{key:n,attrs:{to:{name:"tag",params:{name:e.name}}}},[s("b-tag",{attrs:{type:"is-info is-light mr-1"}},[t._v(" "+t._s("#"+e.name)+" ")])],1)})),1)],1)]),t.token&&t.user.id===t.topicUser.id?s("div",{staticClass:"level-right"},[s("router-link",{staticClass:"level-item",attrs:{to:{name:"topic-edit",params:{id:t.topic.id}}}},[s("span",{staticClass:"tag"},[t._v("ç¼–è¾‘")])]),s("a",{staticClass:"level-item"},[s("span",{staticClass:"tag",on:{click:function(e){return t.handleDelete(t.topic.id)}}},[t._v("åˆ é™¤")])])],1):t._e()])]),s("lv-comments",{attrs:{slug:t.topic.id}})],1),s("div",{staticClass:"column"},[t.flag?s("Author",{attrs:{user:t.topicUser}}):t._e(),t.flag?s("recommend",{attrs:{"topic-id":t.topic.id}}):t._e()],1)])},a=[],i=(s("96cf"),s("1da1")),o=s("5530"),r=s("2423"),c=s("2f62"),l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{attrs:{id:"author"}},[s("el-card",{attrs:{shadow:"never"}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",{staticClass:"has-text-weight-bold"},[t._v("ğŸ‘¨â€ğŸ’» å…³äºä½œè€…")])]),s("div",{staticClass:"has-text-centered"},[s("p",{staticClass:"is-size-5 mb-5"},[s("router-link",{attrs:{to:{path:"/member/"+t.user.username+"/home"}}},[t._v(" "+t._s(t.user.alias)+" "),s("span",{staticClass:"is-size-7 has-text-grey"},[t._v(t._s("@"+t.user.username))])])],1),s("div",{staticClass:"columns is-mobile"},[s("div",{staticClass:"column is-half"},[s("code",[t._v(t._s(t.user.topicCount))]),s("p",[t._v("æ–‡ç« ")])]),s("div",{staticClass:"column is-half"},[s("code",[t._v(t._s(t.user.followerCount))]),s("p",[t._v("ç²‰ä¸")])])]),s("div",[t.hasFollow?s("button",{staticClass:"button is-success button-center is-fullwidth",on:{click:function(e){return t.handleUnFollow(t.user.id)}}},[t._v(" å·²å…³æ³¨ ")]):s("button",{staticClass:"button is-link button-center is-fullwidth",on:{click:function(e){return t.handleFollow(t.user.id)}}},[t._v(" å…³æ³¨ ")])])])])],1)},u=[],m=s("b775");function d(t){return Object(m["a"])({url:"/relationship/subscribe/".concat(t),method:"get"})}function p(t){return Object(m["a"])({url:"/relationship/unsubscribe/".concat(t),method:"get"})}function h(t){return Object(m["a"])({url:"/relationship/validate/".concat(t),method:"get"})}var v={name:"Author",props:{user:{type:Object,default:null}},data:function(){return{hasFollow:!1}},mounted:function(){this.fetchInfo()},computed:Object(o["a"])({},Object(c["b"])(["token"])),methods:{fetchInfo:function(){var t=this;null!=this.token&&""!==this.token&&h(this.user.id).then((function(e){var s=e.data;t.hasFollow=s.hasFollow}))},handleFollow:function(t){var e=this;null!=this.token&&""!==this.token?d(t).then((function(t){var s=t.message;e.$message.success(s),e.hasFollow=!e.hasFollow,e.user.followerCount=parseInt(e.user.followerCount)+1})):this.$message.success("è¯·å…ˆç™»å½•")},handleUnFollow:function(t){var e=this;p(t).then((function(t){var s=t.message;e.$message.success(s),e.hasFollow=!e.hasFollow,e.user.followerCount=parseInt(e.user.followerCount)-1}))}}},f=v,g=s("2877"),b=Object(g["a"])(f,l,u,!1,null,"3c33f1ed",null),_=b.exports,C=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-card",{attrs:{shadow:"never"}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",{staticClass:"has-text-weight-bold"},[t._v("ğŸ§ éšä¾¿çœ‹çœ‹")])]),s("div",t._l(t.recommend,(function(e,n){return s("p",{key:n,staticClass:"block ellipsis is-ellipsis-1",attrs:{title:e.title}},[s("router-link",{attrs:{to:{name:"article-detail",params:{id:e.id}}}},[s("span",{staticClass:"tag"},n<9?[t._v(" 0"+t._s(parseInt(n)+1)+" ")]:[t._v(" "+t._s(parseInt(n)+1)+" ")]),t._v(" "+t._s(e.title)+" ")])],1)})),0)])},w=[],x={name:"Recommend",props:{topicId:{type:String,default:null}},data:function(){return{recommend:[]}},created:function(){this.fetchRecommendTopics()},methods:{fetchRecommendTopics:function(){var t=this;Object(r["d"])(this.topicId).then((function(e){var s=e.data;t.recommend=s}))}}},k=x,j=Object(g["a"])(k,C,w,!1,null,"43190419",null),O=j.exports,y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"box comments"},[s("hr"),s("h3",{staticClass:"title is-5"},[t._v("Comments")]),t.token?s("lv-comments-form",{attrs:{slug:t.slug},on:{loadComments:t.fetchComments}}):t._e(),t._l(t.comments,(function(t){return s("lv-comments-item",{key:"comment-"+t.id,attrs:{comment:t}})}))],2)},$=[];function F(t){return Object(m["a"])({url:"/comment/get_comments",method:"get",params:{topicid:t}})}function T(t){return Object(m["a"])({url:"/comment/add_comment",method:"post",data:t})}var I=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("article",{staticClass:"media"},[s("div",{staticClass:"media-content"},[s("form",{on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[s("b-field",[s("b-input",{attrs:{type:"textarea",maxlength:"400",placeholder:"Add a comment...",disabled:t.isLoading},model:{value:t.commentText,callback:function(e){t.commentText=e},expression:"commentText"}})],1),s("nav",{staticClass:"level"},[s("div",{staticClass:"level-left"},[s("b-button",{staticClass:"level-item",attrs:{type:"is-primary","native-type":"submit",disabled:t.isLoading}},[t._v(" Comment ")])],1)])],1)])])},R=[],L={name:"LvCommentsForm",data:function(){return{commentText:"",isLoading:!1}},props:{slug:{type:String,default:null}},methods:{onSubmit:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,s={},console.log(t.commentText),s["content"]=t.commentText,s["topic_id"]=t.slug,e.next=8,T(s);case 8:t.$emit("loadComments",t.slug),t.$message.success("ç•™è¨€æˆåŠŸ"),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](1),t.$buefy.toast.open({message:"Cannot comment this story. ".concat(e.t0),type:"is-danger"});case 15:return e.prev=15,t.isLoading=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[1,12,15,18]])})))()}}},E=L,U=Object(g["a"])(E,I,R,!1,null,null,null),D=U.exports,z=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("article",{staticClass:"media"},[s("figure",{staticClass:"media-left image is-48x48"},[s("img",{attrs:{src:"https://cn.gravatar.com/avatar/"+t.comment.userId+"?s=164&d=monsterid"}})]),s("div",{staticClass:"media-content"},[s("div",{staticClass:"content"},[s("p",[s("strong",[t._v(t._s(t.comment.username))]),s("small",{staticClass:"ml-2"},[t._v(t._s(t._f("date")(t.comment.createTime)))]),s("br"),t._v(" "+t._s(t.comment.content)+" ")])])])])},S=[],A={name:"LvCommentsItem",props:{comment:{type:Object,required:!0}}},M=A,Y=Object(g["a"])(M,z,S,!1,null,null,null),q=Y.exports,H={name:"LvComments",components:{LvCommentsForm:D,LvCommentsItem:q},data:function(){return{comments:[]}},props:{slug:{type:String,default:null}},computed:Object(o["a"])({},Object(c["b"])(["token"])),mounted:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.fetchComments(t.slug);case 2:case"end":return e.stop()}}),e)})))()},methods:{fetchComments:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:console.log(t),F(t).then((function(t){var s=t.data;e.comments=s}));case 2:case"end":return s.stop()}}),s)})))()}}},J=H,B=Object(g["a"])(J,y,$,!1,null,null,null),G=B.exports,K=s("ff41"),N=s.n(K),P=(s("2f2f"),{name:"TopicDetail",components:{Author:_,Recommend:O,LvComments:G},computed:Object(o["a"])({},Object(c["b"])(["token","user"])),data:function(){return{flag:!1,topic:{content:"",id:this.$route.params.id},tags:[],topicUser:{}}},mounted:function(){this.fetchTopic()},methods:{renderMarkdown:function(t){N.a.preview(document.getElementById("preview"),t,{hljs:{style:"github"}})},fetchTopic:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:Object(r["b"])(t.$route.params.id).then((function(e){var s=e.data;document.title=s.topic.title,t.topic=s.topic,t.tags=s.tags,t.topicUser=s.user,t.renderMarkdown(t.topic.content),t.flag=!0}));case 1:case"end":return e.stop()}}),e)})))()},handleDelete:function(t){var e=this;Object(r["a"])(t).then((function(t){var s=t.code,n=t.message;alert(n),200===s&&setTimeout((function(){e.$router.push({path:"/"})}),500)}))}}}),Q=P,V=(s("1e47"),Object(g["a"])(Q,n,a,!1,null,null,null));e["default"]=V.exports},"1e47":function(t,e,s){"use strict";s("8c48")},"8c48":function(t,e,s){}}]);
//# sourceMappingURL=chunk-3a2ef3c1.a8da7826.js.map